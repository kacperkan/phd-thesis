\newcommand{\inpscenenormals}[1]{\includegraphics[height=\height]{\lumigaussdirname/folder_for_kacper/normals/#1.png}}

\newcommand{\normalsshadows}{
  \centering
  {
    \def\spysize{24bp}
    \def\offset{36bp}
    \def\height{84bp}
    \tikzsetnextfilename{shadowd-model-improves-normals}
    \resizebox{0.6\linewidth}{!}{
      \begin{tikzpicture}[
          >=stealth',
          anchor=base,
          align=center,
          spy using outlines={circle, red, magnification=2, connect spies, size=52bp}
        ]
        \matrix[
          matrix of nodes,
          column sep=0pt,
          row sep=0pt,
          ampersand replacement=\&,
          inner sep=0,
          outer sep=0
        ] (normalsshadows) {
          \inpscenenormals{rec_no_shadows} \&
          \inpscenenormals{rec_with_shadows}     \\
          \inpscenenormals{normals_no_shadows} \&
          \inpscenenormals{normals_with_shadows} \\
          % \inpscene{orig_1} \& \inpscene{rec_1} \& \inpscene{novel_1} \\
          % \inpscene{orig_2} \& \inpscene{rec_2} \& \inpscene{novel_2} \\
          % \inpscene{orig_3} \& \inpscene{rec_3} \& \inpscene{novel_3} \\
          % \inpscene{orig_4} \& \inpscene{rec_4} \& \inpscene{novel_4} \\
        };

        \node[above=0.1em of normalsshadows-1-2.north] {Model without shadows $\unshadowed$};
        \node[above=0.1em of normalsshadows-1-1.north] {Shadowed model $\shadowed$};

        \spy[anchor=center] on ([xshift=2.5em,yshift=1.5em] normalsshadows-1-1.center) in node[above right=8bp and 8bp] at (normalsshadows-1-1.south west);
        \spy[anchor=center] on ([xshift=2.5em,yshift=1.5em] normalsshadows-1-2.center) in node[above right=8bp and 8bp] at (normalsshadows-1-2.south west);
        \spy[anchor=center] on ([xshift=2.5em,yshift=1.5em] normalsshadows-2-1.center) in node[above right=8bp and 8bp] at (normalsshadows-2-1.south west);
        \spy[anchor=center] on ([xshift=2.5em,yshift=1.5em] normalsshadows-2-2.center) in node[above right=8bp and 8bp] at (normalsshadows-2-2.south west);
      \end{tikzpicture}
    }
  }
}

\begin{figure}[t]
  \centering
  % \includegraphics[width=\linewidth]{images/wild2d-shadowed improves
  % normals.pdf}
  \normalsshadows
  \caption{\textbf{Effects of shadowed training --}
    We show the comparison of \textbf{albedo} between the shadowed
    (\textit{left}) and unshadowed (\textit{right}) models.
    The albedo in the shadowed training is brighter with fewer shadows.
    The shadowed model recovers more accurate normals.
  }
  \label{fig:lumigauss-shadowed_fix_normals}
\end{figure}